<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wordly</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;500;700&family=Outfit:wght@400;500;700&family=Pacifico&display=swap"
        rel="stylesheet">

    <meta name="description" content="Wordly - Juego de palabras multijugador">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" defer></script>
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" defer></script>
    <script src="https://unpkg.com/@rive-app/canvas@latest" defer></script>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>

<body>
    <canvas id="rive-canvas"></canvas>
    <div id="game-container">
        <button id="btn-mute" class="icon-btn" aria-label="Silenciar">
            ðŸ”Š
        </button>
        <div id="toast"></div>
    </div>
    <div id="game-status-message"></div>

    <!-- SCREEN: INTRO -->
    <!-- SCREEN: INTRO -->
    <div id="screen-intro" class="screen">
        <div style="flex-grow: 1;"></div>
        <div class="logo-container">
            <img src="Recursos/Logo.svg" alt="Palabritas Logo" class="logo-svg">
        </div>

        <div class="intro-actions">
            <button id="btn-duelo" class="btn btn-primary btn-full" onclick="goToNameInput()">
                Duelo online
            </button>
            <button id="btn-entrenamiento" class="btn btn-secondary btn-full" onclick="startTraining()">
                Entrenamiento
            </button>
        </div>
    </div>

    <!-- SCREEN: NAME INPUT (New - Hidden for Phase 1) -->
    <div id="screen-name-input" class="screen hidden">
        <div style="flex-grow: 1;"></div>
        <div class="logo-container">
            <h1 class="logo-text">Duelo online</h1>
            <p style="color: rgba(255, 255, 255, 0.6); margin-top: 0; margin-bottom: 0;">Introduce tu nombre para
                empezar</p>
        </div>

        <div class="intro-actions">
            <input type="text" id="username-new" class="input-field" placeholder="Tu nombre" maxlength="10">
            <button id="btn-confirm-name" class="btn btn-primary btn-full" onclick="confirmName()">
                Â¡Vamos!
            </button>
            <button class="btn btn-ghost" onclick="goBackToIntro()">Volver</button>
        </div>
    </div>

    <div id="screen-connect" class="screen hidden">
        <h2>Duelo online</h2>
        <p class="connect-instruction">Conecta con tu rival enviÃ¡ndole este cÃ³digo</p>

        <div class="code-wrapper">
            <div id="my-code" class="code-display">Cargando ID...</div>
            <button class="btn-copy" onclick="copyCode()">Copiar cÃ³digo</button>
        </div>

        <div class="divider">O introduce aquÃ­ el suyo</div>
        <input type="text" id="friend-code" placeholder="Pega aquÃ­ el cÃ³digo">

        <div class="btn-container">
            <button class="btn btn-primary btn-full" onclick="joinGame()">Conectar y jugar</button>
            <button class="btn btn-ghost btn-full" onclick="location.reload()">Volver</button>
        </div>
    </div>

    <div id="screen-game" class="screen hidden">
        <div class="logo-game-svg" id="game-logo-container">
            <img src="Recursos/Logo.svg" alt="Wordly Logo" style="height: 100%; width: auto;">
        </div>

        <div class="scoreboard-container" id="scoreboard">
            <div class="score-card">
                <div id="icon-p1" class="avatar-icon"></div>
                <span class="name" id="name-p1">Yo</span>
                <div class="score-row">
                    <span class="val" id="score-p1">0</span>
                    <span class="added hidden" id="added-p1">+0</span>
                </div>
            </div>
            <div id="card-timer" class="timer-card">
                <span class="timer-big" id="timer-val">30</span>
                <span class="timer-label">segundos</span>
            </div>
            <div class="score-card" id="p2-card">
                <div id="icon-p2" class="avatar-icon"></div>
                <span class="name" id="name-p2">Rival</span>
                <div class="score-row">
                    <span class="val" id="score-p2">0</span>
                    <span class="added hidden" id="added-p2">+0</span>
                </div>
            </div>
        </div>

        <div id="game-active-area"
            style="width: 100%; display: flex; flex-direction: column; flex-grow: 1; justify-content: center;">
            <div
                style="flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                <div class="word-zone-container">
                    <div id="word-zone" class="word-zone"></div>
                </div>
                <div id="pool-zone" class="pool-zone"></div>
            </div>
            <div class="game-footer">
                <button id="btn-left" class="btn btn-soft-blue btn-auto" onclick="handleLeftButton()">Nueva
                    partida</button>
                <button id="btn-action" class="btn btn-white btn-auto" onclick="validateWord()">Validar</button>
            </div>
        </div>

        <div id="result-panel" class="hidden">
            <div class="result-content">
                <div id="res-icon" class="res-icon">ðŸŽ‰</div>
                <h2 id="res-title">Â¡Has ganado!</h2>

                <div id="res-my-word" class="word-result-row" style="margin-top: 16px;"></div>

                <p id="res-subtitle" class="res-subtitle">Rival ha perdido con:</p>
                <div id="res-opp-word" class="word-result-row"></div>
            </div>

            <div style="margin-top: auto; width: 100%; display: flex; justify-content: center;">
                <button class="btn btn-soft-blue btn-auto" onclick="handleLeftButton()">Nueva partida</button>
            </div>
        </div>


</body>

</html>